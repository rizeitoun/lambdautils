AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: Template of AutoBranching Lambda Function
Parameters:
  LambdaFunctionParameter:
    Type: String
    Default: git_branching.lambda_handler
    AllowedValues:
      - git_branching.lambda_handler
      - git_statuses.lambda_handler
    Description: Lambda Function to run.
Resources:
  GitPostEvent:
    Type: AWS::Serverless::Api
    Properties:
      StageName: test
  BranchFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler:
        Ref: LambdaFunctionParameter
      Runtime: python3.7
      CodeUri: ./
      Role: >-
        arn:aws:iam::359042822489:role/service-role/gitBranchChange-role-feip54yw
      Events:
          GetResource:
            Type: Api
            Properties:
              RestApiId: !Ref GitPostEvent
              Path: /git
              Method: ALL
      Environment:
        Variables:
          oauth: >-
            AQICAHiGwA1MaRcBVUzLJnkgfCGNqmYiGUA1FHzkR0Dpvb5WUAFXdYE3/lyST/zqUweqmrR1AAAAhzCBhAYJKoZIhvcNAQcGoHcwdQIBADBwBgkqhkiG9w0BBwEwHgYJYIZIAWUDBAEuMBEEDF/DngKpPgtu/+rapAIBEIBDkY7BbWUQKlGKoMuUS5WJBs5qd5oyC64UWTX+93QmXNkc/fzlI8j7FG6yXiKT+gc38gaZthQlgg0N+SDK34TBKQiV0g==
          secret: >-
            AQICAHiGwA1MaRcBVUzLJnkgfCGNqmYiGUA1FHzkR0Dpvb5WUAEMW8AZPb5jxrD4nhxrMsVrAAAAZDBiBgkqhkiG9w0BBwagVTBTAgEAME4GCSqGSIb3DQEHATAeBglghkgBZQMEAS4wEQQMPtD6uQuhJp21cJbLAgEQgCExQL4D6eZmbBWFUXbEfcCx6rDg5JpM5bMF/v1vleXew8Y=
Outputs:
  GitPostEvent:
    Description: 'API Gateway endpoint URL'
    Value: !Sub 'https://${GitPostEvent}.execute-api.${AWS::Region}.amazonaws.com/test/git'